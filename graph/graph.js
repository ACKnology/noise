//jscs:disable
var raw = [null,null,null,null,-129.6856821468934,-139.95004799187993,-134.05016974644258,-122.44174656019152,-143.94559121630766,-130.2620687681054,-127.28024745033203,-132.39716433377762,-128.51887067645654,-106.07188874484626,-110.92537914596043,-159.73527899842085,-122.89675116179622,-117.65859269593591,-116.43731276904711,-139.36799965223702,-127.65405995102705,-119.12644006478538,-154.20294257365617,-140.38871299352004,-135.5787189708843,-97.33051605489935,-117.65500752121221,-91.53671554185381,-72.7693415069996,-111.71091030678,-105.53022216175877,-109.89624223698108,-95.84326069674132,-122.35410908028888,-103.22222480560959,-106.61556516997786,-93.433465615419,-71.71113618949781,-81.09054185762652,-91.53764828743938,-113.30641042040368,-115.32117362073282,-119.12303312841797,-123.8442679731321,-125.85599399967234,-128.41829687426844,-100.14682279214378,-110.79452798595284,-119.75182065009852,-89.61056692381035,-110.35072118589902,-133.40936070784466,-131.79089394098602,-126.3005190346702,-114.34119026238952,-91.1816764776939,-92.05818916747057,-136.23638515988927,-119.02560853922455,-117.45839441528871,-119.32434911716572,-133.67067412094053,-117.92090082140172,-121.76500439190796,-116.0425232155957,-94.09024124136621,-113.85214060782772,-115.2190785520517,-127.97455710948368,-116.39057088339939,-111.70265023123422,-116.62334246094746,-98.36883201472622,-75.33225303906545,-65.13844427793131,-90.28473537387978,-77.45533305985563,-79.8135690471003,-140.16617171656287,-126.52067926116243,-180.4578481827441,-130.31562052599392,-138.75993499170937,-120.4360120412003,-111.80996702277115,-102.4355940349657,-110.47344645580209,-81.75822165624858,-89.42331586992431,-121.64491801628783,-141.70464254775365,-130.78891078793592,-97.49454095539707,-88.58831431782554,-80.09605745010228,-88.60553284046601,-95.60981690233433,-96.89711782038209,-81.93281741902469,-100.86616420279334,-126.74215939412065,-134.62800715706248,-119.2668502621509,-119.63098861932596,-96.04603461357544,-89.51443277765163,-113.56895895536627,-135.2132281868282,-110.71222827535841,-142.15583471664445,-125.61110508853048,-138.36801835960432,-157.85698093201017,-131.65375914161262,-124.87251063223445,-108.03033210839416,-122.35399391002731,-149.91080888845752,-92.88000302713272,-113.86831652530738,-113.67562046835945,-119.85093602965895,-122.56935975389368,-117.8623982946006,-119.8682887538505,-147.91515407386385,-115.88302688244887,-118.10056766252728,-122.93162882386532,-141.14986079564102,-115.0914100960519,-117.08723917363294,-124.36778399278553,-143.66448333754914,-159.47285237510448,-140.43065105676172,-123.86876789091093,-161.81613719955462,-154.27974834251057,-123.27458049076627,-139.40159084102518,-122.15252256011048,-106.14679065151897,-113.6740363190229,-105.1607561100691,-117.63197943178213,-124.67205098743733,-107.76953656857188,-126.17799996427742,-113.84921123642872,-112.80628423228606,-123.78437100272717,-128.24939915849907,-114.02856032834669,-125.09670071467389,-116.96629554322121,-116.90687621692663,-122.04909355774674,-136.3294432000318,-103.61086250601468,-106.93321828117696,-117.384817139734,-112.7230961860198,-112.35724017579159,-144.8057843550155,-112.60381699266111,-89.4805398783023,-79.04784910109818,-97.78944367146545,-95.81866433133388,-92.8623145922507,-105.77203270475101,-113.04655916081347,-111.77023510743408,-119.10961459031776,-122.19783468178389,-109.31592906458667,-107.61375235348251,-114.14404391074166,-101.54597678590932,-114.5134550738156,-105.2561305433405,-106.96419034484889,-150.6516094946946,-109.6538299966953,-128.40918557749615,-140.73460226159162,-106.66129560075959,-85.87372946891915,-112.80086960646769,-80.02474300218024,-115.51043108309527,-107.81555236666725,-104.96283078884497,-134.40500958832163,-131.9551917032166,-149.17563153893408,-115.9135785031786,-133.8885894243583,-126.59165932660284,-62.39832032085047,-73.7580716121636,-145.12407375213385,-110.7053727246342,-122.42979179877217,-130.50300823839618,-73.3671328813463,-50.87263758623219,-76.05618545804928,-87.42994297906607,-75.94724224524049,-60.30698187191326,-80.92678012068248,-78.69441277572815,-73.14461818286351,-92.0396479356662,-92.83626313024064,-108.11808907894275,-118.3752148521134,-113.83294492003975,-116.41995495940405,-127.27520514738133,-110.17882247289225,-120.33343205768047,-121.00825164319674,-114.21850870606077,-116.07021274428558,-70.67184115726018,-75.7189018537966,-99.89436481973007,-118.47293352584879,-114.19048028122567,-108.5505899840124,-102.15273494483242,-106.94933275257276,-91.06393617699874,-103.94611347129647,-136.01706882455514,-105.4954445015065,-101.94391444435894,-97.69392905619631,-129.04439432691663,-138.39304329413102,-126.00227281784203,-116.46527518787516,-102.20813611097022,-106.0925527768216,-124.89447807483545,-114.47906539112833,-117.54662474395741,-133.76868838984902,-122.66836268832682,-118.75415498601475,-126.86516315584733,-121.71149521604059,-130.14332831188653,-123.99676883367569,-127.13796769020546,-83.2424640073353,-56.86672706151744,-80.0163955088042,-48.12936418633855,-73.84257014737146,-71.7797745888364,-77.32049903486038,-71.30660016351669,-101.63471291730372,-105.34082059708224,-65.98053195847366,-63.32359004694511,-59.23072551362403,-63.522726949169254,-70.32807008015128,-63.913389946196816,-60.76751770490682,-68.813197678223,-82.2732795029033,-95.44498879623717,-105.09236616973473,-144.30913441061017,-119.02337936302774,-126.93723456274256,-106.0473477862736,-85.8114012807197,-102.05283790028476,-55.01604948021275,-48.44001519774832,-69.75281843067785,-74.13920724340838,-99.29017556973227,-101.02530179853846,-140.03112145959477,-117.0766702109076,-121.81279875611719,-118.50652360194431,-117.61093376407754,-130.46538870999765,-174.5561474536736,-128.46999922472645,-111.86698457857904,-145.57295937162644,-123.45642965194271,-107.32476584118359,-102.67926170475886,-94.50808388270806,-111.42153198456741,-86.64843959952532,-126.50891351112011,-137.82157568278214,-116.1395472930331,-119.53240280460149,-120.88406204351728,-135.53097390352997,-139.66545667436637,-128.6882510233597,-119.07754036104458,-110.14258848952771,-123.30231787926188,-117.30198074646009,-97.25028731071589,-88.50800748786423,-67.52868079501278,-36.42063352530599,-26.985060207307573,-49.66419881849533,-38.469597461900285,-57.75019101739417,-46.10268807802977,-63.31832086566925,-64.32177108620155,-101.32854881100712,-77.18811315222099,-73.76175679139196,-77.14719533798059,-22.392201295049865,-17.863479657617404,-27.20479774966016,-33.611580877342114,-13.381495985718399,-41.20452725195332,-15.579415587568334,-14.010416763667301,-26.791726418656342,-35.395824334425185,-47.43342652428035,-55.884229421033034,-52.800223848071454,-59.807259587933274,-70.4542979777054,-76.30368042952847,-85.98778505218502,-83.64252085014004,-102.15074242769106,-109.09065245296705,-123.26747409275333,-109.3111737676603,-114.51573235135199,-141.32986358088417,-111.6138370197517,-130.19356523228186,-116.82653649254412,-128.47901414907477,-128.3528522271548,-127.76235422073484,-143.44363543131033,-132.20785457862786,-151.90268638666763,-127.11416489487262,-116.15575502188749,-133.4347683365686,-141.77504281468418,-128.13969667733932,-119.05136869162243,-171.54609157370652,-129.32732734754296,-141.24670452665703,-158.823568462341,-159.18686045215009,-147.05931049481018,-131.87278995396872,-138.90370560452527,-138.40831419538193,-147.56847064163836,-161.80866036980234,-155.4494920825382,-142.02227996106706,-140.0073353663839,-131.1969896721649,-144.6930121613653,-138.15528191184197,37.868207706037616,39.4074490154808,35.60039518847512,36.97929209216194,32.22770621439507,34.46062147931132,34.385622444238976,29.69417428439656,30.72901159321049,29.646026101888353,28.85651967853411,30.467593657155938,30.04363002886121,29.512333935176468,30.092067325143255,30.43539627485803,30.58401404775907,31.64816589660697,32.65106620633209,33.12862592346145,32.453394829139626,30.43861477380904,29.76531040210783,28.195665514861027,18.083190492040096,30.610233502086697,41.114949389562156,15.932840007643678,2.7090772041258675,-2.82553579219282,0.49496249706607187,-0.4712713604417086,22.937501193128767,39.413564558392245,30.626558555622722,22.069353458882418,38.68920254477031,8.425375248742355,1.465147356150793,8.08786549996867,21.598399334936072,38.44244517980733,28.081844365559455,12.757912978925056,29.12987670901527,38.48033119747259,18.87201577019583,39.91518190676088,23.122867775059337,41.92345824197802,29.19022348047086,24.163368625932534,43.00735312119889,27.54763026022729,9.653367063996395,10.085042236131036,27.96847886660061,42.06697801084231,40.444895903484394,42.03099626819458,32.88048167225114,20.473920721683797,26.00226525270985,40.141126997000256,25.373264813343006,43.8677022748482,29.390401877558247,24.18244562137877,41.57706673097576,36.397266153040675,37.297728576609835,30.636173552841697,9.974104657576868,27.325416044334702,37.56274181031101,16.510379784244776,15.207788225249676,-26.207733842953193,-8.758836269537598,24.92574149538751,39.97436089940487,38.935042155253214,41.53616575020551,38.21244681932367,39.240867333011195,38.31154497494798,36.810240183664334,36.09362616474568,35.23413088718336,33.711616078140615,33.37022731814427,32.859725225291754,32.45327258833974,32.8291155526921,33.00823288383637,33.17532813720178,33.22978825840657,33.18641320002883,33.16100529771378,32.988647708294586,32.732992229828014,32.64258356846118,22.651561362347614,25.43700983765892,6.768294748277732,12.142346997251517,-7.900565109823276,-11.382310784959342,-15.697570756049142,-38.757319870651784,-55.67916274812301,-66.66569619696264,-93.40290342875599,-86.92575265196479,-105.17371593351614,-97.16490737379758,-100.4227433359994,-103.93007952293638,-116.01119914479567,-122.90443543206221,-131.50345684523333,-155.55350171894898,-119.94118670870726,-118.56408978017122,-136.89681192459085,-139.70692274206132,-117.60471093114377,-130.95136167160646,-134.26184018846445,-147.1785926555029,-151.0804272230792,-127.09090366220734,-124.51583709197072,-149.8734728934538,-121.08152649625848,-128.18335951254656,-129.7211142216075,-137.44375115485408,-130.5313230303123,-140.1912108801941,-129.4805259272849,-139.39450431949592,-133.87887674965884,-125.02979284654376,-130.7946056396393,-159.24452248393652,-143.19409911175887,-132.92618107476943,-129.27651927110804,-136.32009558739878,-119.07361684161677,-141.99610531309094,-132.12933746846926,-139.48379113225226,-117.27315657075937,-132.79599416505673,-139.32594781045321,-124.58627113761031,-132.99047006472887,-134.1087026949099,-127.27654776377689,-130.24878349038158,-139.91484675116897,-134.88651921549237,-142.9847740588526,-131.45301191694043,-130.25665795238254,-107.7264531158298,-117.71537208263375,-114.39585370274116,-125.56470148538932,-123.30647694835945,-136.57979631108154,-125.70538870102627,-159.41839453245765,-126.01085506541496,-150.58978619754865,-162.51490751435344,-82.2733199835882,-53.095143621221766,-115.5510935159684,-78.01606541590003,-78.46607245557949,-128.06768319827253,-103.53470495271816,-156.12964875177627,-138.28028215712928,-115.93548950253883,-116.61168325492156,-116.90368278677694,-112.02837744688792,-134.84321395030173,-147.51752568530839,-119.97264855847389,-136.41970870175606,-123.40333464303487,-135.0350048031397,-115.85599025264555,-128.1104994082134,-156.7398272143063,-128.78809618054305,-151.77566254571485,-125.55921714253644,-149.51838704630575,-141.56329850197108,-115.75836836644581,-145.3031865940878,-124.59799841044193,-157.00626275244045,-139.89275298771474,-113.79890224530784,-123.30152504066108,-143.78332082911533,-129.98282976306916,-143.78082609052072,-119.82466702079292,-127.06200710656017,-134.78541512404036,-132.52286881379482,-131.63236149798124,-124.912166563336,-149.3509083217615,-131.90011670341244,-130.5208760999081,-149.09906036322332,-139.48634316360946,-128.25212154512957,-141.844906977443,-125.2011442984089,-121.68484877594489,-127.50642506560793,-133.2257400001298,-139.8802801247718,-121.9683197366232];
//jscs:enable
var rawGraph = document.createElement('canvas');
var rawHeight = 400;
var rawWidth = 600;
rawGraph.setAttribute('height', rawHeight + 'px');
rawGraph.setAttribute('width', rawWidth + 'px');
var rawCtx = rawGraph.getContext('2d');

raw = raw
.filter(function(v) {
  return v !== null && v !== -Infinity;
});

var rawMin = _.min(raw);

raw = raw.map(function(v) {
  // 0 out min
  return v -= rawMin;
});

var rawMax = _.max(raw);

raw = raw
.map(function(v) {
  // Normalize to 0 - 1
  return v / rawMax;
});

raw.forEach(function(v, i) {
  rawCtx.fillRect(i * rawWidth / raw.length, v * rawHeight * 0.95 , 5 , 5);
});

document.body.appendChild(rawGraph);

var movingAverageGraph = document.createElement('canvas');
movingAverageGraph.setAttribute('height', rawHeight + 'px');
movingAverageGraph.setAttribute('width', rawWidth + 'px');
var movingAverageCtx = movingAverageGraph.getContext('2d');
var movingAverageWindow = 20;

movingAverage = raw
.map(function(v, i, arr) {
  for (var j = 0; j < movingAverageWindow && arr[i + j] !== undefined; ++j) {
    v += arr[i + j];
  }
  return v *= 1 / movingAverageWindow;
});

var movingAverageMin = _.min(movingAverage);

movingAverage = movingAverage.map(function(v) {
  return v - movingAverageMin;
});

var movingAverageMax = _.max(movingAverage);

movingAverage = movingAverage.map(function(v) {
  return v / movingAverageMax;
});

movingAverage.forEach(function(v, i) {
  movingAverageCtx.fillRect(i * rawWidth / movingAverage.length, v * rawHeight * 0.95, 5, 5);
});

movingAverageGraph.style.opacity = '0.5';
document.body.appendChild(movingAverageGraph);

var diffGraph = document.createElement('canvas');
diffGraph.setAttribute('height', rawHeight + 'px');
diffGraph.setAttribute('width', rawWidth + 'px');
var diffGraphCtx = diffGraph.getContext('2d');
var diffRange = 40;

diffPoints = movingAverage
.map(function(v, i, arr) {
  return v - _.sum(arr.slice(i, i + diffRange)) / diffRange;
});

var minDiff = _.min(diffPoints);

diffPoints = diffPoints
.map(function(v) {
  return v -= minDiff;
});

var maxDiff = _.max(diffPoints);

diffPoints = diffPoints
.map(function(v) {
  return v / maxDiff;
});

var maxChange = _.max(diffPoints);
var minChange = _.min(diffPoints);
diffPoints
.forEach(function(v, i) {
  diffGraphCtx.fillStyle = 'black';

  if (v == minChange) {
    diffGraphCtx.fillStyle = 'red';
  }

  if (v == maxChange) {
    diffGraphCtx.fillStyle = 'orange';
  }

  diffGraphCtx.fillRect(i * rawWidth / diffPoints.length, v * rawHeight * 0.95, 5, 5);
});

document.body.appendChild(diffGraph);

var dataGraph = document.createElement('canvas');
dataGraph.setAttribute('height', rawHeight + 'px');
dataGraph.setAttribute('width', rawWidth + 'px');
var dataGraphCtx = dataGraph.getContext('2d');

var dataBits = raw.slice(diffPoints.indexOf(minChange) + 20, diffPoints.indexOf(maxChange));

var minDataBit = _.min(dataBits);

dataBits = dataBits.map(function(v) {
  return v - minDataBit;
});

var maxDataBit = _.max(dataBits);

dataBits = dataBits.map(function(v) {
  return v / maxDataBit;
});

dataBits.forEach(function(v, i) {
  dataGraphCtx.fillRect(i * rawWidth / dataBits.length, v * rawHeight * 0.95, 5, 5);
});

document.body.appendChild(dataGraph);
