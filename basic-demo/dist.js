(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.noise = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var stringToBinary = require('string-to-binary');
var binaryToString = require('binary-to-string');

var Audio = window.AudioContext || window.webkitAudioContext;
var context = new Audio();
var SAMPLE_RATE = context.sampleRate;
var bufferFrameSize = 2048;
var baud = 45.45;
var low = 2125;
var high = 2295;
var binsPerBit = Math.ceil(SAMPLE_RATE / baud);
var lastTime = 0;

function getNumberOfPaddingBits(bitsPerSecond) {
  return Math.ceil(bitsPerSecond / 2) + 2;
}

function decode(out, baud) {
  var BitThreshold = 65 - 0.18 * baud;

  var unmap = out.map(function (v) {
    return v.m > BitThreshold ? 1 : 0;
  });
  var unpadded = unpadSignal(unmap, baud);

  document.querySelector('#output').innerHTML = binaryToString(unpadded.join(''));
}

function unpadSignal(bits, bitsPerSecond) {
  bits = bits.slice(getNumberOfPaddingBits(bitsPerSecond));
  return bits.slice(0, -getNumberOfPaddingBits(bitsPerSecond));
}

function padSignal(bits, bitsPerSecond) {
  var padBits = '';

  for (var i = 0; i < getNumberOfPaddingBits(bitsPerSecond); ++i) {
    padBits += i < getNumberOfPaddingBits(bitsPerSecond) - 2 ? '1' : 0;
  }

  return padBits + bits + padBits;
}

function hamming(n, N) {
  return 0.54 - 0.47 * Math.cos(2 * Math.PI * n / N);
}

function goertzel(k, binsPerBit, raw, out) {
  var realW = 2 * Math.cos(2 * Math.PI * k / binsPerBit);
  var imagW = Math.sin(2 * Math.PI * k / binsPerBit);

  while (raw.length >= binsPerBit) {
    var chunk = raw.slice(0, binsPerBit);
    raw = raw.slice(binsPerBit);
    var d1 = 0;
    var d2 = 0;

    for (var i = 0; i < binsPerBit; ++i) {
      var x = chunk[i];
      x *= hamming(x, binsPerBit);
      var y = x + realW * d1 - d2;
      d2 = d1;
      d1 = y;
    }

    var r = 0.5 * realW * d1 - d2;
    var im = imagW * d1;

    out.push({
      real: r,
      imag: im * d1,
      m: 20 * Math.log(Math.sqrt(Math.pow(r, 2) + Math.pow(im, 2)))
    });
  }

  return raw;
}

function run() {
  var out = [];
  var data = padSignal(stringToBinary(document.querySelector('#input').value), baud);
  var remainder = [];
  var k = 0.5 + binsPerBit * high / SAMPLE_RATE;
  var length = 1 / baud;

  var osc = context.createOscillator();
  var processor = context.createScriptProcessor(bufferFrameSize, 1, 1);

  osc.connect(processor);
  osc.connect(context.destination);
  processor.connect(context.destination);

  processor.onaudioprocess = function (e) {
    var processData = e.inputBuffer.getChannelData(0);
    remainder = remainder.concat(Array.prototype.slice.call(processData, 0));
    remainder = goertzel(k, binsPerBit, remainder, out);
  };

  data.split('').forEach(function (v, i) {
    osc.frequency.setValueAtTime(v == '1' ? high : low, i * length + context.currentTime);
  });

  osc.start(context.currentTime);
  osc.frequency.value = 0;

  osc.stop(data.length * length + context.currentTime);
  lastTime = data.length * length;

  osc.onended = function () {
    osc.disconnect(processor);
    osc.disconnect(context.destination);
    processor.disconnect(context.destination);
    decode(out, baud);
  };
}

module.exports = {
  run: run
};

},{"binary-to-string":2,"string-to-binary":3}],2:[function(require,module,exports){
module.exports = function(binary) {
  var out = '';
  while(binary.length >= 8) {
   var byte = binary.slice(0, 8);
   var binary = binary.slice(8);
   out += String.fromCharCode(parseInt(byte, 2));
  }

  return out;
}

},{}],3:[function(require,module,exports){
module.exports = function(str) {
  var pad = "00000000";

  return str.split('').map(function(str) {
    var binary = str.charCodeAt(0).toString(2);

    return pad.slice(binary.length)+binary;
  }).join('');
}

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvc2FtL0Rlc2t0b3AvcmVwb3MvYWZzay9iYXNpYy1kZW1vL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2JpbmFyeS10by1zdHJpbmcvaW5kZXguanMiLCJub2RlX21vZHVsZXMvc3RyaW5nLXRvLWJpbmFyeS9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBTSxjQUFjLEdBQUcsT0FBTyxDQUFDLGtCQUFrQixDQUFDLENBQUM7QUFDbkQsSUFBTSxjQUFjLEdBQUcsT0FBTyxDQUFDLGtCQUFrQixDQUFDLENBQUM7O0FBRW5ELElBQU0sS0FBSyxHQUFJLE1BQU0sQ0FBQyxZQUFZLElBQUksTUFBTSxDQUFDLGtCQUFrQixBQUFDLENBQUM7QUFDakUsSUFBTSxPQUFPLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQztBQUM1QixJQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3ZDLElBQU0sZUFBZSxHQUFHLElBQUksQ0FBQztBQUM3QixJQUFNLElBQUksR0FBRyxLQUFLLENBQUM7QUFDbkIsSUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDO0FBQ2pCLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQztBQUNsQixJQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsQ0FBQztBQUNqRCxJQUFJLFFBQVEsR0FBRyxDQUFDLENBQUM7O0FBRWpCLFNBQVMsc0JBQXNCLENBQUMsYUFBYSxFQUFFO0FBQzdDLFNBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0NBQ3pDOztBQUVELFNBQVMsTUFBTSxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUU7QUFDekIsTUFBTSxZQUFZLEdBQUcsRUFBRSxHQUFHLElB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TSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztHQUNuQixDQUFDO0NBQ0g7O0FBRUQsTUFBTSxDQUFDLE9BQU8sR0FBRztBQUNmLEtBQUcsRUFBRSxHQUFHO0NBQ1QsQ0FBQzs7O0FDdkhGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiY29uc3Qgc3RyaW5nVG9CaW5hcnkgPSByZXF1aXJlKCdzdHJpbmctdG8tYmluYXJ5Jyk7XG5jb25zdCBiaW5hcnlUb1N0cmluZyA9IHJlcXVpcmUoJ2JpbmFyeS10by1zdHJpbmcnKTtcblxuY29uc3QgQXVkaW8gPSAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KTtcbmNvbnN0IGNvbnRleHQgPSBuZXcgQXVkaW8oKTtcbmNvbnN0IFNBTVBMRV9SQVRFID0gY29udGV4dC5zYW1wbGVSYXRlO1xuY29uc3QgYnVmZmVyRnJhbWVTaXplID0gMjA0ODtcbmNvbnN0IGJhdWQgPSA0NS40NTtcbmNvbnN0IGxvdyA9IDIxMjU7XG5jb25zdCBoaWdoID0gMjI5NTtcbmNvbnN0IGJpbnNQZXJCaXQgPSBNYXRoLmNlaWwoU0FNUExFX1JBVEUgLyBiYXVkKTtcbmxldCBsYXN0VGltZSA9IDA7XG5cbmZ1bmN0aW9uIGdldE51bWJlck9mUGFkZGluZ0JpdHMoYml0c1BlclNlY29uZCkge1xuICByZXR1cm4gTWF0aC5jZWlsKGJpdHNQZXJTZWNvbmQgLyAyKSArIDI7XG59XG5cbmZ1bmN0aW9uIGRlY29kZShvdXQsIGJhdWQpIHtcbiAgY29uc3QgQml0VGhyZXNob2xkID0gNjUgLSAwLjE4ICogYmF1ZDtcblxuICBsZXQgdW5tYXAgPSBvdXQubWFwKGZ1bmN0aW9uKHYpIHsgcmV0dXJuIHYubSA+IEJpdFRocmVzaG9sZCA/IDEgOiAwOyB9KTtcbiAgbGV0IHVucGFkZGVkID0gdW5wYWRTaWduYWwodW5tYXAsIGJhdWQpO1xuXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNvdXRwdXQnKS5pbm5lckhUTUwgPSBiaW5hcnlUb1N0cmluZyh1bnBhZGRlZC5qb2luKCcnKSk7XG59XG5cbmZ1bmN0aW9uIHVucGFkU2lnbmFsKGJpdHMsIGJpdHNQZXJTZWNvbmQpIHtcbiAgYml0cyA9IGJpdHMuc2xpY2UoZ2V0TnVtYmVyT2ZQYWRkaW5nQml0cyhiaXRzUGVyU2Vjb25kKSk7XG4gIHJldHVybiBiaXRzLnNsaWNlKDAsIC1nZXROdW1iZXJPZlBhZGRpbmdCaXRzKGJpdHNQZXJTZWNvbmQpKTtcbn1cblxuZnVuY3Rpb24gcGFkU2lnbmFsKGJpdHMsIGJpdHNQZXJTZWNvbmQpIHtcbiAgbGV0IHBhZEJpdHMgPSAnJztcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGdldE51bWJlck9mUGFkZGluZ0JpdHMoYml0c1BlclNlY29uZCk7ICsraSkge1xuICAgIHBhZEJpdHMgKz0gaSA8IGdldE51bWJlck9mUGFkZGluZ0JpdHMoYml0c1BlclNlY29uZCkgLSAyID8gJzEnIDogMDtcbiAgfVxuXG4gIHJldHVybiBwYWRCaXRzICsgYml0cyArIHBhZEJpdHM7XG59XG5cbmZ1bmN0aW9uIGhhbW1pbmcobiwgTikge1xuICByZXR1cm4gMC41NCAtIDAuNDcgKiBNYXRoLmNvcygyICogTWF0aC5QSSAqIG4gLyBOKTtcbn1cblxuZnVuY3Rpb24gZ29lcnR6ZWwoaywgYmluc1BlckJpdCwgcmF3LCBvdXQpIHtcbiAgY29uc3QgcmVhbFcgPSAyICogTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBrIC8gYmluc1BlckJpdCk7XG4gIGNvbnN0IGltYWdXID0gTWF0aC5zaW4oMiAqIE1hdGguUEkgKiBrIC8gYmluc1BlckJpdCk7XG5cbiAgd2hpbGUgKHJhdy5sZW5ndGggPj0gYmluc1BlckJpdCkge1xuICAgIGxldCBjaHVuayA9IHJhdy5zbGljZSgwLCBiaW5zUGVyQml0KTtcbiAgICByYXcgPSByYXcuc2xpY2UoYmluc1BlckJpdCk7XG4gICAgbGV0IGQxID0gMC4wO1xuICAgIGxldCBkMiA9IDAuMDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluc1BlckJpdDsgKytpKSB7XG4gICAgICBsZXQgeCA9IGNodW5rW2ldO1xuICAgICAgeCAqPSBoYW1taW5nKHgsIGJpbnNQZXJCaXQpO1xuICAgICAgbGV0IHkgPSB4ICsgcmVhbFcgKiBkMSAtIGQyO1xuICAgICAgZDIgPSBkMTtcbiAgICAgIGQxID0geTtcbiAgICB9XG5cbiAgICBjb25zdCByID0gMC41ICogcmVhbFcgKiBkMSAtIGQyO1xuICAgIGNvbnN0IGltID0gaW1hZ1cgKiBkMTtcblxuICAgIG91dC5wdXNoKHtcbiAgICAgIHJlYWw6IHIsXG4gICAgICBpbWFnOiBpbSAqIGQxLFxuICAgICAgbTogMjAgKiBNYXRoLmxvZyhNYXRoLnNxcnQoTWF0aC5wb3cociwgMikgKyBNYXRoLnBvdyhpbSwgMikpKVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHJhdztcbn1cblxuZnVuY3Rpb24gcnVuKCkge1xuICBsZXQgb3V0ID0gW107XG4gIGxldCBkYXRhID0gcGFkU2lnbmFsKFxuICAgIHN0cmluZ1RvQmluYXJ5KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNpbnB1dCcpLnZhbHVlKSxcbiAgICBiYXVkXG4gICk7XG4gIGxldCByZW1haW5kZXIgPSBbXTtcbiAgbGV0IGsgPSAwLjUgKyAoYmluc1BlckJpdCAqIChoaWdoKSAvIFNBTVBMRV9SQVRFKTtcbiAgbGV0IGxlbmd0aCA9IDEgLyBiYXVkO1xuXG4gIGNvbnN0IG9zYyA9IGNvbnRleHQuY3JlYXRlT3NjaWxsYXRvcigpO1xuICBjb25zdCBwcm9jZXNzb3IgPSBjb250ZXh0LmNyZWF0ZVNjcmlwdFByb2Nlc3NvcihidWZmZXJGcmFtZVNpemUsIDEsIDEpO1xuXG4gIG9zYy5jb25uZWN0KHByb2Nlc3Nvcik7XG4gIG9zYy5jb25uZWN0KGNvbnRleHQuZGVzdGluYXRpb24pO1xuICBwcm9jZXNzb3IuY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcblxuICBwcm9jZXNzb3Iub25hdWRpb3Byb2Nlc3MgPSBmdW5jdGlvbihlKSB7XG4gICAgbGV0IHByb2Nlc3NEYXRhID0gZS5pbnB1dEJ1ZmZlci5nZXRDaGFubmVsRGF0YSgwKTtcbiAgICByZW1haW5kZXIgPSByZW1haW5kZXIuY29uY2F0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHByb2Nlc3NEYXRhLCAwKSk7XG4gICAgcmVtYWluZGVyID0gZ29lcnR6ZWwoaywgYmluc1BlckJpdCwgcmVtYWluZGVyLCBvdXQpO1xuICB9O1xuXG4gIGRhdGEuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24odiwgaSkge1xuICAgIG9zYy5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUodiA9PSAnMScgPyBoaWdoIDogbG93LCBpICogbGVuZ3RoICsgY29udGV4dC5jdXJyZW50VGltZSk7XG4gIH0pO1xuXG4gIG9zYy5zdGFydChjb250ZXh0LmN1cnJlbnRUaW1lKTtcbiAgb3NjLmZyZXF1ZW5jeS52YWx1ZSA9IDA7XG5cbiAgb3NjLnN0b3AoZGF0YS5sZW5ndGggKiBsZW5ndGggKyBjb250ZXh0LmN1cnJlbnRUaW1lKTtcbiAgbGFzdFRpbWUgPSBkYXRhLmxlbmd0aCAqIGxlbmd0aDtcblxuICBvc2Mub25lbmRlZCA9IGZ1bmN0aW9uKCkge1xuICAgIG9zYy5kaXNjb25uZWN0KHByb2Nlc3Nvcik7XG4gICAgb3NjLmRpc2Nvbm5lY3QoY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgcHJvY2Vzc29yLmRpc2Nvbm5lY3QoY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgZGVjb2RlKG91dCwgYmF1ZCk7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBydW46IHJ1blxufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYmluYXJ5KSB7XG4gIHZhciBvdXQgPSAnJztcbiAgd2hpbGUoYmluYXJ5Lmxlbmd0aCA+PSA4KSB7XG4gICB2YXIgYnl0ZSA9IGJpbmFyeS5zbGljZSgwLCA4KTtcbiAgIHZhciBiaW5hcnkgPSBiaW5hcnkuc2xpY2UoOCk7XG4gICBvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChieXRlLCAyKSk7XG4gIH1cblxuICByZXR1cm4gb3V0O1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihzdHIpIHtcbiAgdmFyIHBhZCA9IFwiMDAwMDAwMDBcIjtcblxuICByZXR1cm4gc3RyLnNwbGl0KCcnKS5tYXAoZnVuY3Rpb24oc3RyKSB7XG4gICAgdmFyIGJpbmFyeSA9IHN0ci5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDIpO1xuXG4gICAgcmV0dXJuIHBhZC5zbGljZShiaW5hcnkubGVuZ3RoKStiaW5hcnk7XG4gIH0pLmpvaW4oJycpO1xufVxuIl19
